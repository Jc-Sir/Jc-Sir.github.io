(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{629:function(t,s,a){"use strict";a.r(s);var e=a(25),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"web-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-storage"}},[t._v("#")]),t._v(" Web Storage")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("[提示]")]),t._v(" "),a("ul",[a("li",[t._v("Web Storage的目的是克服由cookie带来的一些限制，当数据需要被严格控制在客户端上时，无须持续地将数据发回服务器。")]),t._v(" "),a("li",[t._v("Web Storage的两个主要目标是：提供一种在cookie之外存储会话数据的途径以及提供一种存储大量可以跨会话存在的数据的机制")])])]),t._v(" "),a("h2",{attrs:{id:"web-storage分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-storage分类"}},[t._v("#")]),t._v(" Web Storage分类")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("[注意]")]),t._v(" "),a("ul",[a("li",[t._v("除了"),a("strong",[t._v("存储的有效期")]),t._v("和"),a("strong",[t._v("作用域")]),t._v("不同，以下这两个对象的属性和方法完全一样")]),t._v(" "),a("li",[t._v("它们很像cookie机制的强化版，能够动用大得多的存储空间。")]),t._v(" "),a("li",[t._v("目前，每个域名的存储上限视浏览器而定，Chrome是2.5MB，Firefox和Opera是5MB，IE是10MB。")]),t._v(" "),a("li",[t._v("其中，Firefox的存储空间由一级域名决定，而其他浏览器没有这个限制。也就是说，在Firefox中，a.example.com和b.example.com共享5MB的存储空间。")]),t._v(" "),a("li",[a("strong",[t._v("另外，与Cookie一样，它们也受同域限制。某个网页存入的数据，只有同域下的网页才能读取")])]),t._v(" "),a("li",[t._v("通过检查window对象是否包含sessionStorage和localStorage属性，可以确定浏览器是否支持这两个对象")]),t._v(" "),a("li",[t._v("[注意]IE浏览器不支持在本地使用storage")])])]),t._v(" "),a("h2",{attrs:{id:"存储有效期-作用域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储有效期-作用域"}},[t._v("#")]),t._v(" 存储有效期&作用域")]),t._v(" "),a("h3",{attrs:{id:"简单介绍下文档源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单介绍下文档源"}},[t._v("#")]),t._v(" 简单介绍下文档源")]),t._v(" "),a("blockquote",[a("p",[t._v("文档源是通过协议、主机和端口三者确定的")])]),t._v(" "),a("p",[t._v("示例说明不同文档源")]),t._v(" "),a("ul",[a("li",[t._v("http://www.example.com      // 协议: http; 主机名：www.example.com")]),t._v(" "),a("li",[t._v("https://www.example.com     // 不同的协议")]),t._v(" "),a("li",[t._v("http://static.example.com   // 不同的主机名")]),t._v(" "),a("li",[t._v("http://www.example.com:8000 // 不同端口")])]),t._v(" "),a("h3",{attrs:{id:"localstorage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#localstorage"}},[t._v("#")]),t._v(" localStorage")]),t._v(" "),a("ul",[a("li",[t._v("作用域限定在文档源级别。")]),t._v(" "),a("li",[t._v("同源文档之间共享【相互读取、覆盖】同样的localhostStorage，反之相互独立。")]),t._v(" "),a("li",[t._v("localStorage保存的数据长期存在，下一次访问该网站的时候，网页可以直接读取以前保存的数据。")])]),t._v(" "),a("h3",{attrs:{id:"sessionstorage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sessionstorage"}},[t._v("#")]),t._v(" sessionStorage")]),t._v(" "),a("ul",[a("li",[t._v("作用域限定在文档源级别。")]),t._v(" "),a("li",[t._v("作用域同样限定在窗口【说明：是顶级窗口】中。不同标签页的sessionStorage数据相互独立。")]),t._v(" "),a("li",[t._v("如果一个标签页包含两个"),a("code",[t._v("<iframe>")]),t._v("元素，他们所包含的文档是同源的，sessionStorage中的数据可以共享。")]),t._v(" "),a("li",[t._v("sessionStorage保存的数据用于浏览器的一次会话，当会话结束(通常是该窗口关闭)，数据被清空。")])]),t._v(" "),a("h2",{attrs:{id:"存取数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存取数据"}},[t._v("#")]),t._v(" 存取数据")]),t._v(" "),a("p",[t._v("sessionStorage和localStorage保存的数据，都以"),a("strong",[t._v("键对")]),t._v("的形式存在。也就是说，每一项数据都有一个键名和对应的值。所有的数据都是以"),a("strong",[t._v("文本格式保存")])]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("[注意]")]),t._v(" "),a("p",[t._v("Storage类型只能存储字符串。非字符串的数据在存储之前会被转换成字符串")])]),t._v(" "),a("h3",{attrs:{id:"setitem-存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setitem-存"}},[t._v("#")]),t._v(" setItem()存")]),t._v(" "),a("ul",[a("li",[t._v("存入数据使用setItem方法。它接受两个参数，第一个是键名，第二个是保存的数据")])]),t._v(" "),a("p",[t._v("[注意]不同的浏览器存入的Storage位置不一样，不能通用")]),t._v(" "),a("h3",{attrs:{id:"getitem-取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#getitem-取"}},[t._v("#")]),t._v(" getItem()取")]),t._v(" "),a("p",[t._v("读取数据使用getItem方法。它只有一个参数，就是键名")]),t._v(" "),a("div",{staticClass:"language-j extra-class"},[a("pre",{pre:!0,attrs:{class:"language-j"}},[a("code",[t._v("var sessionValue "),a("span",{pre:!0,attrs:{class:"token verb keyword"}},[t._v("=")]),t._v(" sessionStorag"),a("span",{pre:!0,attrs:{class:"token verb keyword"}},[t._v("e.")]),t._v("getItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token conjunction variable"}},[t._v('"')]),t._v("key"),a("span",{pre:!0,attrs:{class:"token conjunction variable"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token verb keyword"}},[t._v(";")]),t._v("\nvar localvalue "),a("span",{pre:!0,attrs:{class:"token verb keyword"}},[t._v("=")]),t._v(" localStorag"),a("span",{pre:!0,attrs:{class:"token verb keyword"}},[t._v("e.")]),t._v("getItem"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token conjunction variable"}},[t._v('"')]),t._v("key"),a("span",{pre:!0,attrs:{class:"token conjunction variable"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token verb keyword"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("除了使用setItem()和getItem()方法之外，还可以使用属性来存取数据")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("testkey "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'testvalue'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'testkey'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'testvalue'")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 'value1'")]),t._v("\n")])])]),a("h2",{attrs:{id:"清除数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清除数据"}},[t._v("#")]),t._v(" 清除数据")]),t._v(" "),a("h3",{attrs:{id:"removeitem"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#removeitem"}},[t._v("#")]),t._v(" removeItem()")]),t._v(" "),a("ul",[a("li",[t._v("用于清除某个键名对应的数据")]),t._v(" "),a("li",[t._v("**[注意]**清除不存在的键名不会报错，只会静默失败")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("sessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'key'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'key'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h3",{attrs:{id:"delete操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#delete操作"}},[t._v("#")]),t._v(" delete操作")]),t._v(" "),a("ul",[a("li",[t._v("使用delete操作来清除数据")]),t._v(" "),a("li",[t._v("**[注意]**IE7-浏览器不支持delete操作符来清除storage数据")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("delete")]),t._v(" localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("localStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getItem")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'key1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// null")]),t._v("\n")])])]),a("h3",{attrs:{id:"clear"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clear"}},[t._v("#")]),t._v(" clear()")]),t._v(" "),a("p",[t._v("clear方法用于清除所有保存的数据")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("sessionStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nlocalStorage"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])])]),a("h2",{attrs:{id:"存储事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#存储事件"}},[t._v("#")]),t._v(" 存储事件")]),t._v(" "),a("ul",[a("li",[t._v("该事件只发生在window对象上，在document对象上触发无效，且使用DOM0级、DOM2级事件处理函数都可以")]),t._v(" "),a("li",[t._v("无论对sessionStorage还是localStorage进行操作，都会触发storage事件。")]),t._v(" "),a("li",[t._v("当通过属性或setItem()方法保存数据，使用delete操作符或removeItem()删除数据，或者调用clear()方法时，都会发生该事件")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("[提示]")]),t._v(" "),a("ul",[a("li",[t._v("只有当存储"),a("strong",[t._v("数据真正发生改变")]),t._v("的时候才会触发存储事件。像给已经存在的存储项设置一个一模一样的值，抑或是删除一个本来就不存在的存储项都是不会触发存储事件的。")]),t._v(" "),a("li",[t._v("通过getItem()方法获取数据也不会触发该事件")])]),t._v(" "),a("p",[t._v("一般地，storage事件不在导致数据变化的当前页面触发。如果浏览器同时打开一个域名下面的多个页面，当其中的一个页面改变sessionStorage或localStorage的数据时，其他所有页面的storage事件会被触发，而原始页面并不触发storage事件。可以通过这种机制，实现多个窗口之间的通信")])]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("[注意]")]),t._v(" "),a("p",[t._v("[注意]IE8-浏览器不支持storage事件，IE9+浏览器与其他标准浏览器有所不同，无论数据真实值是否变化，只要对数据进行设置或删除，都会触发该事件，且原始页面和同一域名下的其他页面都会触发")])]),t._v(" "),a("p",[a("strong",[t._v("事件的event对象属性")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("触发事件的链接地址\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("设置或者删除的键名\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("newvalue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("如果是设置值，则是新值；如果是删除键，则是"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("oldValue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("键被更改之前的值\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("storageArea")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("返回触发事件的对象\n")])])]),a("h3",{attrs:{id:"监听storage事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#监听storage事件"}},[t._v("#")]),t._v(" 监听storage事件")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("window.addEventListener('storage',function(e){\n    console.log('key='+e.key+',oldValue='+e.oldValue+',newValue='+e.newValue);\n})\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);