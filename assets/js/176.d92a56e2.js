(window.webpackJsonp=window.webpackJsonp||[]).push([[176],{741:function(t,e,a){"use strict";a.r(e);var s=a(25),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vue-中-this-set"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-中-this-set"}},[t._v("#")]),t._v(" vue 中 this.$set")]),t._v(" "),a("p",[t._v("向响应式对象中添加一个 "),a("code",[t._v("property")]),t._v("，并确保这个新 "),a("code",[t._v("property")]),t._v(" 同样是响应式的，且触发视图更新。它必须用于向响应式对象上添加新 "),a("code",[t._v("property")]),t._v("，因为 Vue 无法探测普通的新增 "),a("code",[t._v("property")])]),t._v(" "),a("h2",{attrs:{id:"出现的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出现的问题"}},[t._v("#")]),t._v(" 出现的问题")]),t._v(" "),a("p",[a("strong",[t._v("两种情况下修改数据 Vue 是不会触发视图更新的")])]),t._v(" "),a("ul",[a("li",[t._v("当我们给响应式的对象新增属性时，新增的属性并不会显示到页面中；这是由于对象及其属性在 vue 初始化时已处理成响应式的，即当我们改变对象的值或属性的值时，会触发其在页面上的更新，但是当页面加载完成后，新增的属性 b 和 c 就不是响应式的，虽然能在对象中新增属性，但新增的属性并不是响应式的，也就无法体现在页面上。")]),t._v(" "),a("li",[t._v("同样的对于响应式的数组，增加元素、修改数组长度时，数组的这些变化也不会反映到页面中。数组本身是发生变化了，但是没有及时体现在页面上。")])]),t._v(" "),a("h2",{attrs:{id:"如何解决上述问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何解决上述问题"}},[t._v("#")]),t._v(" 如何解决上述问题")]),t._v(" "),a("p",[t._v("通常使用 vue 中的"),a("code",[t._v("this.$set()")]),t._v("来解决")]),t._v(" "),a("p",[t._v("this.$set(target, propertyName/index, value)时，target 为需要添加属性的对象/数组，propertyName 是要添加的属性名|index 是数组下标，value 为属性 propertyName/index 对应的值。")]),t._v(" "),a("h2",{attrs:{id:"原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[t._v("#")]),t._v(" 原理")]),t._v(" "),a("p",[t._v("因为响应式数据 我们给对象和数组本身都增加了"),a("code",[t._v("__ob__")]),t._v("属性，代表的是 "),a("code",[t._v("Observer")]),t._v(" 实例。当给对象新增不存在的属性 首先会把新的属性进行响应式跟踪 然后会触发对象"),a("code",[t._v("__ob__")]),t._v("的 "),a("code",[t._v("dep")]),t._v(" 收集到的 "),a("code",[t._v("watcher")]),t._v(" 去更新，当修改数组索引时我们调用数组本身的 "),a("code",[t._v("splice")]),t._v(" 方法去更新数组")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineReactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" val"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dep"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=n.exports}}]);